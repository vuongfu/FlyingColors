@model TutorOnline.Web.Models.TutorInfoViewModels

<script src="~/Scripts/jquery-3.1.1.js"></script>
@{
    ViewBag.Title = "Chi tiết ứng viên gia sư";
    Layout = "~/Views/Shared/_Layout_BackendUser.cshtml";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <h3 style="margin-bottom: -40px;">Chi tiết ứng viên gia sư</h3>
            @Html.ActionLink("Trở lại", "PretutorIndex", "TutorManagement", null, new { @class = "btn btn-info pull-right" })
        </div>
    </div>
    <hr />
    <div class="panel panel-primary">
        <div class="panel-heading">
            <strong>Ứng viên: </strong>@Html.DisplayFor(model => model.FullName)
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-2">
                    @if (String.IsNullOrEmpty(Model.Photo))
                    {
                        @("N/A")
                    }
                    else
                    {
                        <img src="~/Content/Uploads/Images/Thumbnails/@Model.Photo.Substring(3)" class="img-circle" width="90" height="90" />
                    }
                </div>
                <div class="col-md-10">
                    <div class="row">
                        <h4 style="color:deepskyblue">Thông tin gia sư</h4>
                        <table class="table">
                            <tr>
                                <td><strong>Họ và tên: </strong>@Html.DisplayFor(model => model.FullName)</td>
                            </tr>
                            <tr>
                                <td><strong>Giới tính: </strong>@Html.DisplayFor(model => model.Gender)</td>
                            </tr>
                            <tr>
                                <td><strong>Ngày sinh: </strong>@Html.DisplayFor(model => model.BirthDate)</td>
                            </tr>
                            <tr>
                                <td><strong>Địa chỉ: </strong>@Html.DisplayFor(model => model.Address)</td>
                            </tr>
                            <tr>
                                <td><strong>Thành phố: </strong>@Html.DisplayFor(model => model.City)</td>
                            </tr>
                            <tr>
                                <td><strong>Quốc gia: </strong>@Html.DisplayFor(model => model.Country)</td>
                            </tr>
                            <tr>
                                <td><strong>Mã bưu chính: </strong>@Html.DisplayFor(model => model.PostalCode)</td>
                            </tr>
                            <tr>
                                <td><strong>Email: </strong>@Html.DisplayFor(model => model.Email)</td>
                            </tr>
                            <tr>
                                <td><strong>Skype: </strong>@Html.DisplayFor(model => model.SkypeId)</td>
                            </tr>
                            <tr>
                                <td><strong>Số điện thoại: </strong>@Html.DisplayFor(model => model.PhoneNumber)</td>
                            </tr>
                            <tr>
                                <td><strong>Số tài khoản: </strong>@Html.DisplayFor(model => model.BankId)</td>
                            </tr>
                            <tr>
                                <td><strong>Tên chủ thẻ: </strong>@Html.DisplayFor(model => model.BMemName)</td>
                            </tr>
                            <tr>
                                <td><strong>Tên ngân hàng: </strong>@Html.DisplayFor(model => model.BankName)</td>
                            </tr>
                            <tr>
                                <td><strong>Mã bưu chính: </strong>@Html.DisplayFor(model => model.PostalCode)</td>
                            </tr>
                            <tr>
                                <td><strong>Lương/1 buổi dạy: </strong>@Html.DisplayFor(model => model.Salary)</td>
                            </tr>
                            <tr>
                                <td><strong>Mô tả: </strong>@Html.DisplayFor(model => model.Description)</td>
                            </tr>
                            <tr>
                                <td><strong>Ngày được phê duyệt: </strong>@Html.DisplayFor(model => model.RegisterDate)</td>
                            </tr>
                            <tr>
                                <td><strong>Trạng thái: </strong>@Html.DisplayFor(model => model.isActived)</td>
                            </tr>
                        </table>
                        <hr />
                        <h4 style="color:deepskyblue">Khóa học đăng ký dạy</h4>

                        @if (Model.newTutorSub != null)
                        {
                            foreach (var item in Model.newTutorSub)
                            {
                                <table class="table">
                                    <tr>
                                        <td><strong>Tên khóa dạy: </strong>@Html.DisplayFor(modelItem => item.subjectName)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Kinh nghiệm: </strong>@Html.DisplayFor(modelItem => item.experiences)</td>
                                    </tr>
                                </table>
                                <hr />
                            }
                        }

                        @*<a href="@Url.Action("ApprovedPreTutor", "TutorManagement", new { model = Model, tuId = Model.TutorId })" class="btn btn-success">Phê duyệt trở thành gia sư</a> | 
                        <a href="@Url.Action("RejectedPreTutor", "TutorManagement", new { tusubId = Model.newTusubId, tuId = Model.TutorId })" class="btn btn-danger">Từ chối</a>*@
                        <input type="button" class="btn btn-success" name="btnSubmit" value="Phê duyệt trở thành gia sư" onclick="ApprovedPreTutor()" /> | 
                        <input type="button" class="btn btn-danger" name="btnSubmit" value="Từ chối" onclick="RejectedPreTutor()" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var tusubId = new Array();
    function bindData(){
        @foreach(var item in Model.newTusubId)
        {
            @Html.Raw("tusubId.push(" + item + ");");
        }
    }
    var tuId = @Model.TutorId;

    function ApprovedPreTutor() {
        bindData();
        $.ajax({
        url: '@Url.Action("ApprovedPreTutor", "TutorManagement")',
            dataType: "json",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            traditional: true,
            data: JSON.stringify({ 'tusubId': tusubId, 'tuId': tuId }),
            success: function (response) {
                if(response.Approved == true){
                    window.location.href = '@Url.Action("PretutorIndex", "TutorManagement")';
                }
            }
        });
    }

    function RejectedPreTutor() {
        bindData();
        $.ajax({
            url: '@Url.Action("RejectedPreTutor", "TutorManagement")',
            dataType: "json",
            type: "POST",
            contentType: 'application/json; charset=utf-8',
            traditional: true,
            data: JSON.stringify({ 'tusubId': tusubId, 'tuId': tuId }),
            success: function (response) {
                if(response.Rejected == true){
                    window.location.href = '@Url.Action("PretutorIndex", "TutorManagement")';
                }
            }
        });
    }
</script>
